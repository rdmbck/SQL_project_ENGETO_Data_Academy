/*
 * vytvoreni primarni tabulky - rok, kod a nazev odvetvi, prumerna mzda
 * "5958" - kod pro hrubou mzdu 
 */

CREATE OR REPLACE TABLE t_rdm_bck_project_SQL_primary_final AS    
	SELECT 	cp.payroll_year,
		cp.industry_branch_code,
		cpib.name AS industry_branch_name,
		round(avg(cp.value), 0) AS average_industry_wage
FROM czechia_payroll cp
JOIN czechia_payroll_industry_branch cpib -- pripojeni nazvu odvetvi
	ON cp.industry_branch_code = cpib.code 
WHERE value_type_code = "5958" 
	AND cp.industry_branch_code IS NOT NULL -- vyrayeni prumeru za cela odvetvi 
GROUP BY payroll_year, industry_branch_code 
ORDER BY payroll_year
; 
